#:kivy 1.11.1
#:import webbrowser webbrowser
#:import os os

<UserLabel>:
    canvas.before:
        Color:
            rgba: 0.211,0.218,0.179,1
        RoundedRectangle:
            size: self.size
            pos: self.pos
    width: self.size[0]
    text_size: self.size[0]*0.9,self.size[1]*0.9
    halign:'left'
    valign: 'center'
<base>:
    md_bg_color: self.theme_cls.backgroundColor
    FloatLayout:
        MDTopAppBar:
            type: "small"
            pos_hint: {'x':0,'top':1}
            size_hint: 1,0.1
            MDTopAppBarLeadingButtonContainer:
                MDActionTopAppBarButton:
                    icon: "menu"
                    on_release: root.open()

            MDTopAppBarTitle:
                text: "Exam builder"
                pos_hint: {"center_x": .5}

            MDTopAppBarTrailingButtonContainer:

                MDActionTopAppBarButton:
                    icon: "account-circle-outline"
        MDNavigationLayout:
            MDScreenManager:
                id: nd
                ProfileScreen:
                    name:'profile'
                    id:profile
                HomeScreen:
                    name: 'home'
                    id: home
                ExamScreen:
                    name: 'exam'
                    id: exam
                PracticeScreen:
                    name: 'practice'
                    id: practice            
                StudyMaterialScreen:
                    name: 'st_m'
                    id: st_m 
                PdfSubjectsScreen:
                    name:'pdfs'
                    id:pdfs
                AdminScreen:
                    name:'admin'
                    id:admin
                AboutusScreen:
                    name:'aboutus'
                    id:aboutus
            MDNavigationDrawer:
                drawer_type: "modal"
                close_on_click: True
                id: nav_drawer
                radius: 0, 0, 0, 0
                MDNavigationDrawerMenu:
                    MDNavigationDrawerItem:
                        on_release: nd.current = "home"
                        MDNavigationDrawerItemText:
                            text: "Home"
                    MDNavigationDrawerItem:
                        on_release: nd.current = "exam"
                        MDNavigationDrawerItemText:
                            text: "Exam"
                    MDNavigationDrawerItem:
                        on_release: nd.current = "practice"
                        MDNavigationDrawerItemText:
                            text: "Practice"
                    MDNavigationDrawerItem:
                        on_release: nd.current = "st_m"
                        MDNavigationDrawerItemText:
                            text: "Study Materials"
                    MDNavigationDrawerItem:
                        on_release: nd.current = "aboutus"
                        MDNavigationDrawerItemText:
                            text: "About Us"


<HomeScreen>:
    ScrollView:
        do_scroll_x:True
        do_scroll_y:False
        size_hint: 0.6,0.4
        pos_hint: {'x':0.03,'y':0.45}
        auto_scroll:True
        FloatLayout:
            size_hint:4,1
            FitImage:
                size_hint: 0.245,1
                pos_hint: {'x':0.0,'y':0}
                source: "imagess\\we.jpg"
                fit_mode: 'cover'
                radius: 20
            
            FitImage:
                size_hint: 0.245,1
                pos_hint: {'x':0.25,'y':0}
                source: "imagess\\cor.jpg"
                fit_mode: 'cover'
                radius: 20
            FitImage:
                size_hint: 0.245,1
                pos_hint: {'x':0.5,'y':0}
                source: "imagess\\pw.jpg"
                fit_mode: 'cover'
                radius: 20
            FitImage:
                size_hint: 0.245,1
                pos_hint: {'x':0.75,'y':0}
                source: "imagess\\is.jpg"
                fit_mode: 'cover'
                radius: 20
    TabbedPanel:
        pos_hint:{'x':0.03,'y':0.032}
        size_hint:0.59,0.4
        do_default_tab: False
        tab_width:200
        TabbedPanelItem:
            text: 'Exam sessions'
            ScrollView:
                do_scroll_y: True
                do_scroll_x: False
                GridLayout:
                    size_hint_y: 2
                    canvas.before:
                        Color:
                            rgba: 0.65,0.79,0.785,1 
                        Rectangle:
                            size: self.size
                            pos: self.pos
                    id: Exam_table
                    cols:4
                    spacing:10
                    padding:10
                    row_force_default:True
                    row_default_height: 40

                    TableHeader:
                        text: '[b]S.No[/b]'
                        color: 'white'
                        size_hint_x: 0.1
                        markup: True
                    TableHeader:
                        text: '[b]Subject[/b]'
                        color: 'white'
                        size_hint_x: 0.3
                        markup: True
                    TableHeader:
                        text: '[b]Date & Time[/b]'
                        color: 'white'
                        size_hint_x: 0.4
                        markup: True
                    TableHeader:
                        text: '[b]Marks[/b]'
                        color: 'white'
                        size_hint_x: 0.18
                        markup: True
        TabbedPanelItem:
            text: 'Practice sessions'
            ScrollView:
                do_scroll_y: True
                do_scroll_x: False
                GridLayout:
                    size_hint_y: 2
                    canvas.before:
                        Color:
                            rgba: 0.65,0.79,0.785,1 
                        Rectangle:
                            size: self.size
                            pos: self.pos
                    id: Practice_table
                    cols:4
                    spacing:10
                    padding:10
                    row_force_default:True
                    row_default_height: 40

                    TableHeader:
                        text: '[b]S.No[/b]'
                        color: 'white'
                        size_hint_x: 0.1
                        markup: True
                    TableHeader:
                        text: '[b]Subject[/b]'
                        color: 'white'
                        size_hint_x: 0.3
                        markup: True
                    TableHeader:
                        text: '[b]Started Time[/b]'
                        color: 'white'
                        size_hint_x: 0.4
                        markup: True
                    TableHeader:
                        text: '[b]Duration[/b]'
                        color: 'white'
                        size_hint_x: 0.18
                        markup: True
                
<TableHeader@Label>:
    canvas.before:
        Color:
            rgba: 0.93,0.39,0.32,1
        Rectangle:
            size: self.size
            pos: self.pos
    width: self.size[0]
<TableData>:
    canvas.before:
        Color:
            rgba: 0.45,0.54,0.457,1
        Rectangle:
            size: self.size
            pos: self.pos
    width: self.size[0]
<ProfileScreen@MDScreen>:
    FloatLayout:
        size_hint:0.2,0.7
        pos_hint:{'center_x':0.5,'y':0.2}
        FloatLayout:
            id:pic
            pos_hint: {'center_x':0.5,'y':0.4}
            size_hint: 1,0.6
            canvas:
                Color:
                    rgba: [0.92, 0.92, 1, 1]
                Ellipse:
                    size: self.size[0], self.size[0]
                    pos: self.pos
                Color:
                    rgba: [1, 1, 1, 1]
                Ellipse:
                    size: self.size[0], self.size[0]
                    pos: self.pos
                    source:os.path.join('imagess','baseprofile.jpg')
        MDButton:
            on_release: app.root.get_screen('base').show_alert_dialog()
            pos_hint: {'center_x':0.5,'top':0.45}
            size_hint: 0.075,0.1
            md_bg_color: self.theme_cls.primaryColor
            MDButtonText:
                text: "Upload"
        MDTextField:
            id:user
            pos_hint: {'center_x':0.5,'top': 0.3}
            size_hint: 1.5,0.1
            mode: 'outlined'
            MDTextFieldHintText:
                text: "Enter Username"
            MDTextFieldHelperText:
                text: "Don't enter 'Guest'"
        MDButton:
            pos_hint: {'center_x':0.5,'top': 0.1}
            size_hint: 1.5,0.1
            on_release: app.root.get_screen('base').createuser()
            MDButtonText:
                text: "Create User/ Login"
        


<ExamScreen@MDScreen>:
    MDLabel:
        text: "Subjects"
        halign: 'left'
        size_hint: 0.8,0.1
        pos_hint:{'top':0.8,'center_x':0.5}
        font_style: "Headline"
        role: "small"

    GridLayout:
        id: subjects
        size_hint:0.8,0.3
        pos_hint:{'center_x':0.5,'top': 0.7}
        cols:4
        spacing: 15




<PracticeScreen@MDScreen>:
    GridLayout:
        id: subjects
        size_hint:0.8,0.1
        pos_hint:{'center_x':0.5,'top': 0.8}
        cols:4
        spacing: 15



<StudyMaterialScreen@MDScreen>:
    ScrollView:
        do_scroll_x:False
        do_scroll_y:True
        size_hint: 0.95,0.8
        pos_hint: {'center_x':0.5,'center_y':0.45}
        FloatLayout:
            size_hint: 1,6
            id: sm_page
            MDLabel:
                size_hint: 1,0.1
                pos_hint:{'center_x':0.5,'center_y': 0.85}
                text: "Say goodbye to textbook clutter and hello to a streamlined study experience! This page is your treasure trove of learning resources, packed with everything you need to master any subject. Explore a comprehensive library of study materials, from in-depth PDFs to bite-sized summaries. Whether you're a visual learner or prefer detailed explanations, you'll find the perfect resources to solidify your understanding and ace your exams. Dive in and unlock your academic potential"
                text_color: "black"
                font_style: "Title"
            FitImage:
                source: "imagess\\pdfavailable.png"
                size_hint: 0.6,0.1
                pos_hint: {'x':0.2,'y':0.9}
                fit_mode: 'contain'
                radius: 20
            MDLabel:
                size_hint: 0.45,0.1
                pos_hint:{'x':0.05,'center_y': 0.80}
                text: '\u2022'+"  Free PDF's available"
                text_color: "black"
                font_style: "Title"
            MDLabel:
                size_hint: 0.45,0.1
                pos_hint:{'x':0.65,'center_y': 0.80}
                text: '\u2022'+"  Simple and understandable"
                text_color: "black"
                font_style: "Title"
            MDLabel:
                size_hint: 0.45,0.1
                pos_hint:{'x':0.05,'center_y': 0.79}
                text: '\u2022'+"  Full syllabus coverage"
                text_color: "black"
                font_style: "Title"
            MDLabel:
                size_hint: 0.45,0.1
                pos_hint:{'x':0.65,'center_y': 0.79}
                text: '\u2022'+"  Effort free study"
                text_color: "black"
                font_style: "Title"
            GridLayout:
                size_hint: 1,0.1
                pos_hint: {'x':0,'y':0.66}
                id: sem
                cols: 3
                spacing:20
                padding:10
                
<SemCard>:
    size_hint:1,0.25
    pos_hint:{'x':0,'y':0}
    text: root.text
    font_size: '30'
    background_color: 1,1,1,0
    canvas.before:
        Color:
            rgba:0,0,1,1
        RoundedRectangle:
            size: self.size
            pos: self.pos
                
<ExamCard>:
    theme_bg_color: 'Custom'
    md_bg_color: rgba(237,125,49,255)
    shadow_color: self.theme_cls.tertiaryColor
    FloatLayout:
        FitImage:
            source: root.file
            size_hint:0.3,0.3
            pos_hint:{'center_x':0.7,'center_y':0.7}
            fit_mode:'contain'
        Label:
            text: '{}'.format(root.subject)
            size_hint:1,0.9
            pos_hint:{'center_x':0.5,'y':0.1}
            text_size: self.size
            halign: 'center'
            valign: 'center'
            padding:10,10
            font_color:rgba(0,0,0,1)
            font_size: root.width//7
        MDButton:
            size_hint:0.6,0.2
            pos_hint:{'center_x':0.5,'y':0.15}
            on_release: root.start()
            MDButtonText:
                text: "Start exam"



<PdfCard>:
    style:'outlined'
    theme_bg_color: 'Custom'
    md_bg_color: rgba(237,125,49,255)
    shadow_color: self.theme_cls.tertiaryColor
    FloatLayout:
        Label:
            text: '{}'.format(root.subject)
            size_hint:0.7,0.8
            pos_hint:{'center_x':0.4,'top':0.9}
            text_size: self.size
            halign: 'left'
            valign: 'top'
            wrap:True
            font_color:rgba(0,0,0,1)
            font_size: 28

        MDIconButton:
            icon: "arrow-right-bold"
            pos_hint: {"right": 0.95, "center_y": .5}
            theme_bg_color: 'Custom'
            md_bg_color: 'white'
            on_release:webbrowser.open('file:///' + os.path.abspath(os.path.join(r'_internal\pdfs',root.file)))

<AdminScreen>:
    FloatLayout:
        MDSegmentedButton:
            id:pages
            pos_hint: {'center_x':0.5,'center_y':0.8}
            size_hint_x:0.8
            MDSegmentedButtonItem:
                id:page1
                on_active:app.root.get_screen('base').admin_content()
                MDSegmentButtonLabel: 
                    text: 'Exam'
            MDSegmentedButtonItem:
                id:page2
                on_active:app.root.get_screen('base').admin_content()
                MDSegmentButtonLabel:
                    text: 'Study Materials'
            MDSegmentedButtonItem:
                id:page3
                on_active:app.root.get_screen('base').admin_content()
                MDSegmentButtonLabel:
                    text: 'Students'
        FloatLayout:
            pos_hint: {'center_x': 0.5,'top': 0.7}
            size_hint: 0.8,0.6
            id: content
<Upload_admin>:
    on_release:root.show_alert_dialog()
<AboutusScreen@MDScreen>:
    FloatLayout:
        pos: self.pos
        size: self.size
        FitImage:
            source: r'imagess/jntulogo.png'
            pos_hint: {"x": 0, "y": 0.5}
            size_hint: .3, .4
        Label:
            text:'[b]JAWAHARLAL NEHRU TECHNOLOGICAL UNIVERSITY HYDERABAD\nUNIVERSITY COLLEGE OF ENGINEERING MANTHANI[/b]'
            pos_hint: {"x": 0.45, "y": 0.6}
            size_hint: 0.3,0.3
            font_size: 36
            color: 'black'
            halign: 'center'
            markup: True
        Label:
            text:'[b][u]UNDER GUIDENCE OF : [/u][/b]\nMr. G. Sridhar\n\nAssistant Professor,\nComputer Science Dept.'
            pos_hint: {"x": 0, "y": 0.1}
            size_hint: 0.3,0.3
            font_size: 28
            color: 'black'
            markup: True
        Label:
            text: '[b][u]Team Members : [/u][/b]\n1. Vidyasagar Vadla  -22VD1A6609\n2. MD. Musharaf  -22VD1A6621\n3. Sai Gowtham  -22VD1A6632\n'
            pos_hint: {"x": 0.6, "y": 0.1}
            size_hint: 0.3,0.3
            font_size: 28
            color: 'black'
            markup: True
        Label:
            text: '[b][i]Computer Science and Engineering (Artificial Intelligence and Machine Learning)[/b][/i]\n[b]Project Name : [/b]Exam Builder & Preparator'
            pos_hint: {"x": 0, "y": 0.4}
            size_hint: 1,0.1
            font_size: 30
            color: 'black'
            markup: True
<QuestionScreen>:
    md_bg_color:self.theme_cls.backgroundColor
    FloatLayout:
        size_hint:0.6,1
        pos_hint:{'x':0,'y':0}
        FitImage:
            id:img
            pos_hint: {'top':0.9,'x':0.05}
            size_hint_x: 0.9
            size_hint_y: 0.6
            source: root.file
            fit_mode:'scale-down'
            adaptive_height:True

        MDCheckbox:
            group: 'options'
            pos_hint: {'x':0.1,'center_y':0.2}
            size_hint:None,None
            size: "48dp", "48dp"
            on_active:root.selection('a')
        MDLabel:
            text: "A"
            adaptive_height: True
            pos_hint: {"x":0.16,"center_y": 0.2}
        MDCheckbox:
            group: 'options'
            pos_hint: {'x':0.25,'center_y':0.2}
            size_hint:None,None
            size: "48dp", "48dp"
            on_active:root.selection('b')
        MDLabel:
            text: "B"
            adaptive_height: True
            pos_hint: {"x":0.31,"center_y": 0.2}
        MDCheckbox:
            group: 'options'
            pos_hint: {'x':0.4,'center_y':0.2}
            size_hint:None,None
            size: "48dp", "48dp"
            on_active:root.selection('c')
        MDLabel:
            text: "C"
            adaptive_height: True
            pos_hint: {"x":0.46,"center_y": 0.2}
        MDCheckbox:
            group: 'options'
            pos_hint: {'x':0.55,'center_y':0.2}
            size_hint:None,None
            size: "48dp", "48dp"
            on_active:root.selection('d')
        MDLabel:
            text: "D"
            adaptive_height: True
            pos_hint: {"x":0.61,"center_y": 0.2}
        MDButton:
            pos_hint: {'x': 0.75,'center_y': 0.2}
            size_hint: None,None
            size: "400dp","48dp"
            on_release: root.save_next(*args)
            MDButtonText:
                text: 'Save & Next'
        
    FloatLayout:
        size_hint:0.4,1
        pos_hint:{'x':0.6,'y':0}
        ScrollView:
            do_scroll_x:True
            do_scroll_y:False
            size_hint: 0.8,0.5
            pos_hint: {'x':0.1,'y':0.2}
            GridLayout:
                padding: 10
                cols: 5
                size_hint: 2,1
                pos_hint:{'center_x':0.5,'center_y':0.5}
                id:questions
                spacing:15
        Label:
            id: Time
            pos_hint: {'center_x':0.5,'center_y':0.8}
            size_hint: 0.8,0.175
            text: '00:00:00'
            font_size: 60
            color: 'black'
            text_size: self.size
            halign: 'center'
            valign: 'center'
            canvas.before:
                Color:
                    rgba: 1,0,1,1
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [ (20, 20), (20, 20), (20, 20), (20, 20)]
        MDButton:
            pos_hint: {'center_x': 0.5,'center_y': 0.1}
            size_hint: 0.8,0.1
            style: 'outlined'
            theme_width: "Custom"
            theme_height: "Custom"
            size_hint_x: 0.5
            size_hint_y: 0.1
            theme_bg_color: 'Custom'
            md_bg_color: '#05a8aa'
            on_release:root.submit(*args)
        Label:
            pos_hint: {'center_x': 0.5,'center_y': 0.1}
            size_hint: 0.8,0.1
            text: 'Submit'
            color: "black"
            halign:'center'
            font_size: 30

<ResultScreen>:
    md_bg_color: rgba(237,125,49,255)
    shadow_color: self.theme_cls.tertiaryColor
    FloatLayout:
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        size_hint: 0.8,0.8
        canvas:
            Color:
                rgba: 0.133,0.219,0.262,1
            RoundedRectangle:
                pos:self.pos
                size:self.size
                radius: [ (40, 40), (40,40), (20, 20), (20, 20)]
            Color:
                rgba: 0.937,0.945,0.953,1
            RoundedRectangle:
                pos:0.12*root.width,0.12*root.height
                size: 0.76*root.width,0.61*root.height
                radius: [ (20, 20), (20, 20), (20, 20), (20, 20)]
        Label:
            pos_hint: {'center_x': 0.5,'center_y': 0.9}
            size_hint: 1, 0.075
            markup: True
            text: 'SCORE CARD'
            color: 'white'
            font_size: 50
            halign: 'center'
        Label:
            id:marks
            pos_hint: {'x': 0.1,'center_y': 0.55}
            size_hint: 1, 0.3
            markup:True
            text: 'Marks Obtained :  {}\nMax Marks          :  {}\nPercentage         :  {}\nGrade                    :  {} '.format(0,0,'100%','A+')
            color: 'black'
            text_size:self.size
            font_size: 30
            halign: 'left'        
        Button:
            id:mainmenu
            pos_hint: {'center_x': 0.5,'y': 0.1}
            size_hint: 0.3,0.1
            text: 'Back to Main Menu'
            text_color: 'white'
            background_color: 'grey'
            border: 15,15,15,15
            background_down: 'gray'
            on_release: root.backtomain()
        FitImage:
            id:pfimage
            source: 'imagess//pass.png'
            pos_hint: {'x': 0.7,'y':0.3}
            size_hint: 0.2,0.2
            fit_mode: 'contain'


<PdfSubjectsScreen>:
    ScrollView:
        do_scroll_y: True
        size_hint:0.8,0.8
        pos_hint: {'center_x': 0.5,'center_y': 0.5}
        GridLayout:
            id: subjects_pdf
            size_hint:1,None
            pos_hint:{'center_x':0.5,'top': 0.7}
            cols:2
            row_default_height:100
            row_force_default:True
            spacing: 15
            padding: 10
<PracticeQuestionsScreen>:

    md_bg_color:self.theme_cls.backgroundColor
    FloatLayout:
        size_hint:0.6,1
        pos_hint:{'x':0,'y':0}
        FitImage:
            id:img
            pos_hint: {'top':0.9,'x':0.05}
            size_hint_x: 0.9
            size_hint_y: 0.6
            source: root.file
            fit_mode:'scale-down'
            adaptive_height:True

        MDCheckbox:
            group: 'options'
            pos_hint: {'x':0.1,'center_y':0.2}
            size_hint:None,None
            size: "48dp", "48dp"
            on_active:root.selection('a')
        MDLabel:
            text: "A"
            adaptive_height: True
            pos_hint: {"x":0.16,"center_y": 0.2}
        MDCheckbox:
            group: 'options'
            pos_hint: {'x':0.25,'center_y':0.2}
            size_hint:None,None
            size: "48dp", "48dp"
            on_active:root.selection('b')
        MDLabel:
            text: "B"
            adaptive_height: True
            pos_hint: {"x":0.31,"center_y": 0.2}
        MDCheckbox:
            group: 'options'
            pos_hint: {'x':0.4,'center_y':0.2}
            size_hint:None,None
            size: "48dp", "48dp"
            on_active:root.selection('c')
        MDLabel:
            text: "C"
            adaptive_height: True
            pos_hint: {"x":0.46,"center_y": 0.2}
        MDCheckbox:
            group: 'options'
            pos_hint: {'x':0.55,'center_y':0.2}
            size_hint:None,None
            size: "48dp", "48dp"
            on_active:root.selection('d')
        MDLabel:
            text: "D"
            adaptive_height: True
            pos_hint: {"x":0.61,"center_y": 0.2}
        Button:
            pos_hint: {'center_x': 0.7,'center_y': 0.2}
            size_hint: 0.05,0.05
            color: 'white'
            background_color: '#15616d'
            text: '<'
            on_release: root.nav(-1)
        Button:
            pos_hint: {'center_x': 0.8,'center_y': 0.2}
            size_hint: 0.15,0.05
            color: 'white'
            background_color: '#15616d'
            text: 'Save'
            on_release: root.save(*args)
        Button:
            pos_hint: {'center_x': 0.9,'center_y': 0.2}
            size_hint: 0.05,0.05
            color: 'white'
            background_color: '#15616d'
            text: '>'
            on_release: root.nav(+1)
        
        
    FloatLayout:
        size_hint:0.4,1
        pos_hint:{'x':0.6,'y':0}
        Label:
            id: Time
            pos_hint: {'center_x':0.5,'center_y':0.8}
            size_hint: 0.8,0.175
            text: '0:00:00'
            font_size: 60
            color: 'black'
            text_size: self.size
            halign: 'center'
            valign: 'center'
            canvas.before:
                Color:
                    rgba: 1,0,1,1
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [ (20, 20), (20, 20), (20, 20), (20, 20)]
        Button:
            pos_hint: {'center_x': 0.5,'center_y': 0.1}
            size_hint: 0.5,0.05
            text: 'Exit Practice'
            color: 'white'
            background_color: '#15616d'
            on_release: root.backtomain(*args)
        Label:
            id:explanation
            pos_hint: {'x':0.1,'top':0.65}
            size_hint: 0.8,0.6
            color: 'black'
            text: 'Chosen Option : \nAnswer: \nExplanation : '
            text_size: self.size
            font_size: root.width//50
            halign: 'left'
            valign: 'top'